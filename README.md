# å¤–é“¾Excelåˆå¹¶å·¥å…· - Webç‰ˆ

è¿™æ˜¯ä¸€ä¸ªåŸºäºFlaskçš„Webåº”ç”¨ç¨‹åºï¼Œç”¨äºåˆå¹¶ä»Semrushå¯¼å‡ºçš„ä¸¤ç§å¤–é“¾Excelæ–‡ä»¶ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç½‘é¡µä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†å¹¶è¿”å›åˆå¹¶åçš„Excelæ–‡ä»¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ **ç½‘é¡µç•Œé¢** - ç®€æ´ç¾è§‚çš„ç”¨æˆ·ç•Œé¢
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ ** - æ”¯æŒæ‹–æ‹½æˆ–ç‚¹å‡»ä¸Šä¼ Excelæ–‡ä»¶
- ğŸ”§ **è‡ªåŠ¨å¤„ç†** - è‡ªåŠ¨æå–åŸŸåã€åˆå¹¶æ•°æ®
- ğŸ“Š **æ™ºèƒ½æ’åº** - æŒ‰åŸŸåè¯„åˆ†é™åºã€åŸŸåå‡åºæ’åˆ—
- ğŸš€ **å®æ—¶ä¸‹è½½** - å¤„ç†å®Œæˆåè‡ªåŠ¨ä¸‹è½½åˆå¹¶æ–‡ä»¶
- ğŸ“± **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡

## æœ¬åœ°è¿è¡Œ

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. å¯åŠ¨åº”ç”¨

**æ–¹æ³•ä¸€ï¼šç›´æ¥è¿è¡Œï¼ˆå¼€å‘æ¨¡å¼ï¼‰**
```bash
python3 app.py
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨Gunicornï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**
```bash
gunicorn --bind 0.0.0.0:5000 app:app
```

**æ–¹æ³•ä¸‰ï¼šåå°è¿è¡Œ**
```bash
nohup python3 app.py > app.log 2>&1 &
```

**æ–¹æ³•å››ï¼šä½¿ç”¨screen/tmuxä¿æŒä¼šè¯**
```bash
# ä½¿ç”¨screen
screen -S backlink-app
python3 app.py
# æŒ‰ Ctrl+A+D åˆ†ç¦»ä¼šè¯

# ä½¿ç”¨tmux
tmux new -s backlink-app
python3 app.py
# æŒ‰ Ctrl+B+D åˆ†ç¦»ä¼šè¯
```

### 3. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://127.0.0.1:5000

### 4. åœæ­¢åº”ç”¨

**å¦‚æœä½¿ç”¨ç›´æ¥è¿è¡Œï¼š**
- æŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡å™¨

**å¦‚æœä½¿ç”¨åå°è¿è¡Œï¼š**
```bash
ps aux | grep "python3 app.py"
kill <è¿›ç¨‹ID>
```

**å¦‚æœä½¿ç”¨screen/tmuxï¼š**
```bash
# screen
screen -r backlink-app
# ç„¶åæŒ‰ Ctrl+C

# tmux
tmux attach -t backlink-app
# ç„¶åæŒ‰ Ctrl+C
```

## éƒ¨ç½²åˆ°Vercel

### 1. æ¨é€åˆ°GitHub

```bash
git add .
git commit -m "Add web application for backlink merging"
git push origin main
```

### 2. éƒ¨ç½²åˆ°Vercel

1. ç™»å½• [Vercel](https://vercel.com)
2. ç‚¹å‡» "New Project"
3. é€‰æ‹©æ‚¨çš„GitHubä»“åº“
4. ç”±äºVercelä¸èƒ½è‡ªåŠ¨æ£€æµ‹Flaskï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®ï¼š

**Framework Preset**: é€‰æ‹© `Other`
**Build Command**: ç•™ç©º
**Output Directory**: ç•™ç©º
**Install Command**: `pip install -r requirements.txt`

5. ç‚¹å‡» "Deploy"

### 3. ç¯å¢ƒå˜é‡é…ç½®

åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
FLASK_ENV=production
SECRET_KEY=your-secret-key-here
MAX_CONTENT_LENGTH=52428800  # 50MB in bytes
```

### 4. Vercelç‰¹å®šé…ç½®è¯´æ˜

ç”±äºVercelæ˜¯æ— æœåŠ¡å™¨å¹³å°ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- **æ–‡ä»¶å¤„ç†**ï¼šä¸´æ—¶æ–‡ä»¶å­˜å‚¨åœ¨ `/tmp` ç›®å½•
- **å†…å­˜é™åˆ¶**ï¼šé»˜è®¤å‡½æ•°è¶…æ—¶æ—¶é—´ä¸º10ç§’ï¼Œå·²é…ç½®ä¸º30ç§’
- **æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šæœ€å¤§50MBï¼Œè¶…è¿‡éœ€è¦å‡çº§Vercelè®¡åˆ’
- **å¹¶å‘å¤„ç†**ï¼šæ”¯æŒå¤šä¸ªç”¨æˆ·åŒæ—¶ä¸Šä¼ 

### 5. æ•…éšœæ’é™¤

**éƒ¨ç½²åé‡åˆ°é—®é¢˜ï¼š**
1. æ£€æŸ¥Vercelå‡½æ•°æ—¥å¿—
2. ç¡®è®¤æ‰€æœ‰ä¾èµ–åŒ…åœ¨requirements.txtä¸­
3. éªŒè¯ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
4. æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡é™åˆ¶

## ä½¿ç”¨è¯´æ˜

### è¾“å…¥æ–‡ä»¶è¦æ±‚

1. **backlinks.xlsx** - åŒ…å«åŸŸåè¯„åˆ†å’ŒåŸŸåä¿¡æ¯
   - å¿…é¡»åŒ…å«åˆ—ï¼š`Domain ascore`, `Domain`

2. **backlinks_refdomains.xlsx** - åŒ…å«æ¥æºæ ‡é¢˜å’ŒURLä¿¡æ¯
   - å¿…é¡»åŒ…å«åˆ—ï¼š`Source title`, `Source url`

### ä½¿ç”¨æ­¥éª¤

1. æ‰“å¼€ç½‘é¡µåº”ç”¨
2. ç‚¹å‡»"é€‰æ‹©backlinks.xlsxæ–‡ä»¶"æŒ‰é’®ï¼Œä¸Šä¼ ç¬¬ä¸€ä¸ªæ–‡ä»¶
3. ç‚¹å‡»"é€‰æ‹©backlinks_refdomains.xlsxæ–‡ä»¶"æŒ‰é’®ï¼Œä¸Šä¼ ç¬¬äºŒä¸ªæ–‡ä»¶
4. ç‚¹å‡»"åˆå¹¶æ–‡ä»¶å¹¶ä¸‹è½½"æŒ‰é’®
5. ç­‰å¾…å¤„ç†å®Œæˆï¼Œè‡ªåŠ¨ä¸‹è½½åˆå¹¶åçš„æ–‡ä»¶

### è¾“å‡ºæ–‡ä»¶æ ¼å¼

åˆå¹¶åçš„æ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š

| åˆ—å | è¯´æ˜ |
|------|------|
| Domain ascore | åŸŸåè¯„åˆ† |
| Domain | åŸŸå |
| Source title | æ¥æºé¡µé¢æ ‡é¢˜ |
| Source url | æ¥æºé¡µé¢URL |

## æ–‡ä»¶ç»“æ„

```
web_app/
â”œâ”€â”€ app.py              # Flaskåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–åŒ…
â”œâ”€â”€ vercel.json        # Vercelé…ç½®æ–‡ä»¶
â”œâ”€â”€ vercel_app.py      # Vercelå…¥å£æ–‡ä»¶
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html     # ä¸»é¡µæ¨¡æ¿
â”œâ”€â”€ static/            # é™æ€æ–‡ä»¶ç›®å½•
â””â”€â”€ uploads/          # ä¸´æ—¶ä¸Šä¼ ç›®å½•
```

## APIæ¥å£

### POST /upload

ä¸Šä¼ å¹¶åˆå¹¶æ–‡ä»¶

**è¯·æ±‚å‚æ•°:**
- `backlinks_file`: backlinks.xlsxæ–‡ä»¶
- `refdomains_file`: backlinks_refdomains.xlsxæ–‡ä»¶

**å“åº”:** 
- æˆåŠŸ: è¿”å›åˆå¹¶åçš„Excelæ–‡ä»¶
- å¤±è´¥: è¿”å›é”™è¯¯ä¿¡æ¯å¹¶é‡å®šå‘åˆ°é¦–é¡µ

### POST /api/merge

APIæ¥å£ï¼Œè¿”å›JSONæ ¼å¼çš„åˆå¹¶ç»“æœ

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "records_count": 15000,
  "columns": ["Domain ascore", "Domain", "Source title", "Source url"],
  "sample_data": [...]
}
```

## æŠ€æœ¯æ ˆ

- **åç«¯**: Flask, Pandas, OpenPyXL
- **å‰ç«¯**: HTML5, CSS3, JavaScript
- **éƒ¨ç½²**: Vercel, Gunicorn

## é™åˆ¶è¯´æ˜

- æœ€å¤§æ–‡ä»¶å¤§å°: 50MB
- æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: .xlsx, .xls
- å¤„ç†è¶…æ—¶æ—¶é—´: 30ç§’

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦ä¸º.xlsxæˆ–.xls
   - ç¡®ä¿æ–‡ä»¶å¤§å°ä¸è¶…è¿‡50MB
   - éªŒè¯æ–‡ä»¶åŒ…å«å¿…éœ€çš„åˆ—

2. **åˆå¹¶ç»“æœä¸ºç©º**
   - ç¡®ä¿ä¸¤ä¸ªæ–‡ä»¶åŒ…å«åŒ¹é…çš„åŸŸå
   - æ£€æŸ¥URLæ ¼å¼æ˜¯å¦æ­£ç¡®

3. **éƒ¨ç½²é—®é¢˜**
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–åŒ…éƒ½åœ¨requirements.txtä¸­
   - æ£€æŸ¥Vercelé…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®

### å¼€å‘æ¨¡å¼è°ƒè¯•

```bash
export FLASK_ENV=development
python3 app.py
```

## è®¸å¯è¯

MIT License